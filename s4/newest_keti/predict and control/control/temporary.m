clear all
clc
W1_L=[    1.5954    0.0944   -1.5150   -0.1822   -0.2041   -0.2570    0.1059    0.0178    0.8328
   -7.0414    4.2851    1.4973    0.1346    0.4027   -0.0782   -0.2167    0.1027   -0.8742
   -1.1116   -1.0986    1.2383   -0.2217   -0.8396   -0.0283    0.7044    0.3585   -0.8222
    5.1273   -9.2403   -0.5062   -0.1124   -0.3977    0.8291   -0.3197    0.1805    3.7742
   -0.0325    0.7693    1.3264   -0.0221   -0.4059    2.2513    0.1124    0.4665   -1.6235
   -7.3135    2.8828    2.4495   -0.1035   -0.3550   -0.1950    0.3573    0.4548   -0.5450
   -8.1083    1.6334    2.6954   -0.3256   -0.6375   -0.3527    0.5599    0.4324    0.2662
   -2.7338    0.6543    1.3998    0.1942    0.3708    0.2207   -0.1895   -0.0090   -0.6714
    5.9048   -3.9353   -0.9701   -0.2046   -0.7535    0.0130    0.4476    0.1167    0.9359
   -5.7546    9.8329    0.9548    0.0716    0.3811   -0.8847    0.4104   -0.1628   -4.0724
   -7.8912    0.8702    2.5471   -0.3660   -0.6847   -0.3864    0.5937    0.4166    0.5537
   -1.2971    2.8783   -0.5947    0.2116    0.6423   -0.3713   -0.6075    0.0098    0.4846
   -1.5604    2.4519   -0.3160    0.0413    0.3363   -0.4759   -0.2980    0.0954    0.6542
    0.1234    0.8440    0.9548   -0.0123   -0.3234    1.8326    0.1397    0.3812   -1.3665];
W2_L=[   -3.9306   -3.5866   -2.4866    1.8453   -0.8408    3.9770   -5.7190   -4.5743   -3.2409    1.6313    3.9404   -2.2192    2.5437    1.1424   -0.9453];
C=xlsread('C:\Users\JIA\Desktop\论文检索-基于云平台的空调系统负荷预测系统开发\jiaNNPOC _logsig版\预测模型输入数据.xlsx');  
C=C';
C
MM=[    1475.9   -157.7
    1475.9   -157.7
    82        0
    34.8    17.3
    103.1    25
    1094.8         0
    4   -5.6
    5.1   -4.2];
MM
for i=1:8;
    x(i,:)=((C(i,:)-MM(i,2))/(MM(i,1)-MM(i,2)));

end
W1_L
W2_L
x
A=cat(1,x(1:8,10),1);        %输入
B=tansig(W1_L*A);      %隐层输出
[q,p]=size(W2_L);
B(p)=1;               %神经网络工具箱训的偏置关系为+
q=logsig(W2_L*B);        %输出层层输出
q=(q*(MM(1,1)-MM(1,2))+MM(1,2));
q
%q = LOAD_FORECAST(x(1:8,1),W1_L,W2_L);
%q